deptrac:
    paths:
        - ./app

    layers:
        # Layer definition
        - name: Entity
          collectors:
              - type: classLike
                value: .*App\\Domain\\Entity\\.*

        - name: Models
          collectors:
              - type: classLike
                value: .*App\\Domain\\Models\\.*

        - name: Enums
          collectors:
              - type: classLike
                value: .*App\\Domain\\ValueObject\\Enums\\.*

        - name: InfrastructureRepository
          collectors:
              - type: classLike
                value: .*App\\Infrastructure\\Repositories\\.*

        - name: DomainContract
          collectors:
              - type: classLike
                value: .*App\\Domain\\Repository\\Eloquent\\Contracts\\.*

#      - name: Domain
#        collectors:
#          - type: directory
#            regex: app/Domain
#
#      - name: Application
#        collectors:
#          - type: directory
#            regex: app/Application
#
#      - name: Infrastructure
#        collectors:
#          - type: directory
#            regex: app/Infrastructure
#
      # Vendor
#        - name: DomainVendor
#          collectors:
#              - type: classLike
#                regex: ^(Brick\\Math|Brick\\Money|Doctrine\\Common\\Collections|Ramsey\\Uuid)\\.*

      # Allow domain to use selected vendor libs
        - name: AllowedVendors
          collectors:
#              - type: bool
#                must:
#                    - type: classLike
#                      value: Psr\\.*
#                must_not:
#                    - type: classLike
#                      value: Psr\\.*\\Test\\.*
              - type: classLike
                value: Illuminate\\.*
              - type: classLike
                value: Symfony\\.*
              - type: classLike
                value: Carbon\\.*

        - name: OtherVendors
          collectors:
              - type: directory
                value: '/vendor\/(?!webmozart|doctrine|psr|symfony\/uid).*/'

    ruleset:
        Entity:
            - AllowedVendors
            - Enums

        Models:
            - Enums

        DomainContract:
            - AllowedVendors
            - Models

#      Domain:
#          - DomainVendor
#      Application:
#          - Domain
#          - DomainVendor
#      Infrastructure:
#          - Domain
#          - Application
#          - DomainVendor
#          - Vendor

        InfrastructureRepository:
            - AllowedVendors
            - DomainContract
            - Entity
            - Models
            - Enums

        AllowedVendors:
            - OtherVendors

        OtherVendors:
            - AllowedVendors
