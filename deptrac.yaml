deptrac:
    paths:
        - ./app

    layers:
        # Layer definition
        - name: DTO
          collectors:
              - type: classLike
                value: .*App\\Presentation\\Http\\DTO\\.*

        - name: Entity
          collectors:
              - type: classLike
                value: .*App\\Domain\\Entity\\.*

        - name: Models
          collectors:
              - type: classLike
                value: .*App\\Domain\\Models\\.*

        - name: Enums
          collectors:
              - type: classLike
                value: .*App\\Domain\\ValueObject\\Enums\\.*

        - name: Resources
          collectors:
              - type: classLike
                value: .*App\\Presentation\\Http\\Resources\\.*

        - name: Requests
          collectors:
              - type: classLike
                value: .*App\\Presentation\\Http\\Requests\\.*

        - name: Controllers
          collectors:
            - type: classLike
              value: .*App\\Presentation\\Http\\Controllers\\.*

        - name: Services
          collectors:
              - type: classLike
                value: .*App\\Domain\\Services\\.*

        - name: InfrastructureRepository
          collectors:
              - type: classLike
                value: .*App\\Infrastructure\\Repositories\\.*

        - name: DomainContract
          collectors:
              - type: classLike
                value: .*App\\Domain\\Repository\\Eloquent\\Contracts\\.*

      # Allow domain to use selected vendor libs
        - name: AllowedVendors
          collectors:
              - type: classLike
                value: Illuminate\\.*
              - type: classLike
                value: Symfony\\.*
              - type: classLike
                value: Carbon\\.*

        - name: OtherVendors
          collectors:
              - type: directory
                value: '/vendor\/(?!webmozart|doctrine|psr|symfony\/uid).*/'

    ruleset:
        PaginateResources:
            - AllowedVendors

        Requests:
            - AllowedVendors

        Resources:
            - AllowedVendors

        DTO:
            - Requests
            - Enums

        Entity:
            - AllowedVendors
            - Enums

        Models:
            - Enums

        DomainContract:
            - AllowedVendors
            - Models

        Controllers:
            - AllowedVendors
            - Services
            - DTO
            - Requests
            - Resources

        Services:
            - AllowedVendors
            - InfrastructureRepository
            - DomainContract
            - Resources
            - Models
            - DTO

        InfrastructureRepository:
            - AllowedVendors
            - DomainContract
            - Entity
            - Models
            - Enums

        AllowedVendors:
            - OtherVendors

        OtherVendors:
            - AllowedVendors
